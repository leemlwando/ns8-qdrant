#!/usr/bin/env python3

import json
import sys
import os

# Initialize module on first creation
data = json.load(sys.stdin)

# Set default configuration
default_config = {
    "host": "",
    "path": "",
    "lets_encrypt": False,
    "http2https": False,
    "port": 6333,
    "api_key": "",
    "collection_size_limit": 10000,
    "enable_cors": True
}

# Save default configuration
config_file = os.environ.get('AGENT_STATE_DIR', '.') + '/config.json'
with open(config_file, 'w') as f:
    json.dump(default_config, f, indent=2)

# Create environment file with default values
env_file = os.environ.get('AGENT_STATE_DIR', '.') + '/environment'
with open(env_file, 'w') as f:
    f.write(f"QDRANT_PORT={default_config['port']}\n")
    f.write(f"QDRANT_GRPC_PORT=6334\n")
    f.write(f"QDRANT_COLLECTION_SIZE_LIMIT={default_config['collection_size_limit']}\n")
    f.write(f"QDRANT_ENABLE_CORS={'true' if default_config['enable_cors'] else 'false'}\n")

print("Module initialized successfully")
