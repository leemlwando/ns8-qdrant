#!/usr/bin/env python3

#
# Copyright (C) 2023 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-3.0-or-later
#

import json
import sys
import agent
import os

# Read configuration from stored state
config = {
    "ApiKey": "",
    "EnableWebUI": True,
    "HttpsEnabled": True,
    "CustomPath": "/qdrant",
    "CustomHost": "",
    "LetsEncrypt": False
}

# Try to read from config file
try:
    state_dir = os.environ.get("STATE_DIR", os.getcwd())
    config_file_path = os.path.join(state_dir, "config.json")
    with open(config_file_path, "r") as f:
        stored_config = json.load(f)
        config.update(stored_config)
except FileNotFoundError:
    # Use defaults if no config file exists
    pass

json.dump(config, fp=sys.stdout)
