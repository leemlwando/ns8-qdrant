#!/usr/bin/env python3

#
# Copyright (C) 2025 Lee M. Lwando
# SPDX-License-Identifier: GPL-3.0-or-later
#

import json
import sys
import subprocess
import shutil
import os

# Stop and disable the service
try:
    subprocess.run(['systemctl', '--user', 'stop', 'qdrant.service'], 
                  check=False)
    subprocess.run(['systemctl', '--user', 'disable', 'qdrant.service'], 
                  check=False)
except subprocess.SubprocessError:
    pass

# Remove configuration and data directories
directories_to_remove = ['config', 'data', 'snapshots']

for directory in directories_to_remove:
    if os.path.exists(directory):
        try:
            shutil.rmtree(directory)
            print(f"Removed directory: {directory}")
        except OSError as e:
            print(f"Warning: Could not remove {directory}: {e}")

print("Qdrant module destroyed successfully")
